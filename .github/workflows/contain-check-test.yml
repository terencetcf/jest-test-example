name: Contains a string check
on:
    workflow_dispatch:

jobs:
    build:
        runs-on: ubuntu-latest
        env:
            ENVIRONMENT: sandbox

        steps:
            - name: Invoke lambda function
              id: invoke-lambda-step
              run: |
                  output=`Serverless: Load command config
                            Serverless: Load command config:credentials
                            Serverless: Load command cofig:tabcompletion
                            {
                                "statusCode": 200,
                                "body": "{\"message\":\"run was successfully invoked.\",\"response\":\"Ran migration scripts: createIdentitySchemaTables1630649239197\"}"
                            }`
                  echo "$output"
                  echo "::set-output name=invoke-lambda-response::$output"

            - name: verify invoke lambda response
              if: '${{ !contains(steps.invoke-lambda-step.outputs.invoke-lambda-response, ''"statusCode": 200'') }}'
              run: exit 1
